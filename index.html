<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Go-Back-N ARQ ‚Äî Teaching Simulator</title>
  <link rel="stylesheet" href="css/style.css"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>
<body>
  <div id="app">
    <!-- HEADER -->
    <header class="glass header">
      <div class="header-top">
        <h1>Go-Back-N ARQ ‚Äî Visual Simulator</h1>
        <nav class="header-actions">
          <button class="btn pill" id="btnLearn">Learn</button>
          <button class="btn pill" id="btnDev">Developed By</button>
          <button class="btn pill" id="btnHelp">Help</button>
          <button class="btn pill" id="btnDownload">Download</button>
        </nav>
      </div>
      <p class="tagline">
        Sliding window, cumulative ACKs; timeout ‚áí retransmit from base. ACKs only after arrival.
      </p>
    </header>

    <!-- DASHBOARD -->
    <section class="glass controls-wrap">
     <div class="controls-grid">

  <!-- GENERAL SETTINGS -->
  <label>Number of Frames
    <input id="numFrames" type="number" min="1" max="300" value="10"/>
  </label>

  <label>Window Size (N)
    <input id="winSize" type="number" min="1" max="32" value="4"/>
  </label>

  <label>Timeout (ms)
    <input id="timeout" type="number" min="2000" max="60000" value="6000"/>
  </label>

  <!-- FRAME SETTINGS -->
  <label>Frame Loss %
    <input id="lossPercent" type="range" min="0" max="80" value="15"/>
    <span class="inline-val" id="lossPercentVal">15%</span>
  </label>

  <label>Frame Loss Mode
    <select id="lossMode">
      <option value="random">Random (by %)</option>
      <option value="specific">Specific frame(s)</option>
      <option value="everyk">Every k-th</option>
      <option value="none">None</option>
    </select>
  </label>

  <label id="wrapSpecific" class="hidden">Specific Frames (comma)
    <input id="specificFrames" type="text" placeholder="e.g. 2,7,9"/>
  </label>

  <label id="wrapEveryK" class="hidden">k (every k-th)
    <input id="everyK" type="number" min="1" value="3"/>
  </label>

  <label>Frame Delay Mode
    <select id="frameDelayMode">
      <option value="none">None</option>
      <option value="specific">Delay specific frame(s)</option>
      <option value="everyk">Delay every k-th</option>
    </select>
  </label>

  <label id="wrapDelaySpec" class="hidden">Delay Frame # / k
    <input id="frameDelaySpec" type="text" placeholder="e.g. 5 or 3"/>
  </label>

  <label id="wrapDelayMs" class="hidden">Frame Delay (ms)
    <input id="frameDelayMs" type="number" min="0" value="1200"/>
  </label>

  <!-- ACK SETTINGS -->
  <label>ACK Loss %
    <input id="ackLossPercent" type="range" min="0" max="80" value="5"/>
    <span class="inline-val" id="ackLossVal">5%</span>
  </label>

  <label>ACK Loss Mode
    <select id="ackLossMode">
      <option value="random">Random (by %)</option>
      <option value="specific">Specific ACK(s)</option>
      <option value="everyk">Every k-th ACK</option>
      <option value="none">None</option>
    </select>
  </label>

  <label id="wrapAckSpec" class="hidden">Specific ACK # (comma)
    <input id="ackSpecific" type="text" placeholder="e.g. 0,3,7"/>
  </label>

  <label id="wrapAckK" class="hidden">k (every k-th ACK)
    <input id="ackEveryK" type="number" min="1" value="3"/>
  </label>

  <label>ACK Delay (ms)
    <input id="ackDelayMs" type="number" min="0" value="800"/>
  </label>

  <!-- SIMULATION & DIAGRAM -->
  <label>Simulation Mode
    <select id="simMode">
      <option value="textbook">Textbook diagonals (draw + move)</option>
      <option value="vertical">Vertical columns (draw + move)</option>
      <option value="replay">Animated replay (summary only)</option>
    </select>
  </label>

  <label>Summary Diagram
    <select id="diagramType">
      <option value="vertical">Vertical two-columns</option>
      <option value="textbook">Textbook diagonals</option>
      <option value="animated">Animated replay</option>
    </select>
  </label>

</div>
ss


      <div class="controls-actions">
        <button class="btn primary" id="startBtn">Start</button>
        <button class="btn" id="stepBtn">Step</button>
        <button class="btn danger" id="resetBtn">Reset</button>
      </div>
    </section>

    <!-- SIMULATION -->
    <section class="glass sim-shell">
      <div class="lanes">
        <div class="lane">
          <h3>Sender</h3>
          <div id="senderWindow" class="window"></div>
          <div id="senderQueue" class="queue"></div>
        </div>

        <div class="channel">
          <svg id="liveSvg" width="100%" height="100%"></svg>
          <div id="channelStage"></div>
          <div class="axis axis-left">Sender</div>
          <div class="axis axis-right">Receiver</div>
        </div>

        <div class="lane">
          <h3>Receiver</h3>
          <div id="recvArea" class="recv"></div>
        </div>
      </div>
    </section>

    <!-- EVENT LOG -->
    <section class="glass log-shell">
      <h3>Event Log</h3>
      <div id="events" class="log"></div>
    </section>

    <!-- SUMMARY -->
    <section class="glass hidden" id="statsWrap">
      <h3>üìä Simulation Results</h3>
      <div class="stats">
        <div class="stat-card"><div class="stat-label">Total original frames</div><div class="stat-value" id="stat_totalFrames">0</div></div>
        <div class="stat-card"><div class="stat-label">Total transmissions</div><div class="stat-value" id="stat_totalTrans">0</div></div>
        <div class="stat-card"><div class="stat-label">Frames delivered</div><div class="stat-value" id="stat_delivered">0</div></div>
        <div class="stat-card"><div class="stat-label">Total ACKs generated</div><div class="stat-value" id="stat_totalAcks">0</div></div>
        <div class="stat-card"><div class="stat-label">Frames lost</div><div class="stat-value" id="stat_framesLost">0</div></div>
        <div class="stat-card"><div class="stat-label">ACKs lost</div><div class="stat-value" id="stat_acksLost">0</div></div>
        <div class="stat-card"><div class="stat-label">Frames delayed</div><div class="stat-value" id="stat_framesDelayed">0</div></div>
        <div class="stat-card"><div class="stat-label">Efficiency</div><div class="stat-value" id="stat_efficiency">0%</div></div>
        <div class="stat-card"><div class="stat-label">Frames / second</div><div class="stat-value" id="stat_fps">0</div></div>
      </div>

      <div class="diagram-wrap">
        <h4>Flow Diagram (<span id="diagramModeLabel">Vertical two-columns</span>)</h4>
        <div id="diagramHost" class="diagram-host glass-lite"></div>
      </div>
    </section>

    <footer class="footer">
      Created by <b>Sunesh Krishnan N</b> (24BCE1925) & <b>Aravind G</b> (24BCE1293) ¬∑ Guided by <b>Dr. Swaminathan Annadurai</b>
    </footer>
  </div>

  <!-- MODALS -->
  <div class="modal hidden" id="modalLearn">
  <div class="modal-card">
    <div class="modal-head">
      <h3>Learn: Go-Back-N ARQ ‚Äî Visual Guide</h3>
      <button class="icon-btn" data-close="modalLearn">‚úï</button>
    </div>
    <div class="modal-body">
      <p><b>Concept:</b> Go-Back-N ARQ is a <b>sliding window protocol</b> that allows the sender to transmit multiple frames before needing an acknowledgment (ACK) ‚Äî improving efficiency.</p>

      <h4>üîπ How It Works</h4>
      <ul class="bullets">
        <li><b>Sender Window (N):</b> The sender can send up to <i>N</i> unacknowledged frames.</li>
        <li><b>ACK Mechanism:</b> The receiver sends <b>cumulative ACKs</b> ‚Äî e.g., ACK 4 means it has received frames 0-4 correctly.</li>
        <li><b>Timeout:</b> If no ACK arrives for the oldest unacknowledged frame, the sender retransmits all frames from that frame onwards.</li>
        <li><b>Loss Handling:</b> You can simulate losses or delays for both frames and ACKs to observe the protocol‚Äôs behavior.</li>
      </ul>

      <div class="glass-lite" style="padding:10px;margin:14px 0;">
        <h4>üìà Real-World Example</h4>
        <p>Imagine sending 10 data packets with a window size of 4.  
        Frames 0‚Äì3 are sent. If frame 2 is lost, the receiver only ACKs up to 1.  
        When timeout occurs, the sender retransmits from frame 2 ‚Üí onward.</p>
      </div>

      
      </div>

      <h4>üìπ Video Explanation</h4>
      <div class="video">
        <div class="video glass-lite" style="text-align:center; padding:10px;">
  <a href="https://www.youtube.com/watch?v=QD3oCelHJ20" target="_blank" rel="noopener noreferrer">
    <img src="https://img.youtube.com/vi/QD3oCelHJ20/0.jpg" 
         alt="Go-Back-N ARQ Tutorial"
         style="max-width:90%; border-radius:10px; border:1px solid rgba(255,255,255,0.15)">
    <p style="margin-top:8px; color:#00ffff;">‚ñ∂ Watch Go-Back-N ARQ Tutorial on YouTube</p>
  </a>
</div>


      <div class="glass-lite" style="margin-top:14px;padding:10px;">
        <h4>üí° Key Takeaway</h4>
        <p>Go-Back-N is efficient but can waste bandwidth on retransmission when losses occur frequently.  
        That‚Äôs why <b>Selective Repeat</b> ARQ is used when reliability and efficiency are both critical.</p>
      </div>
    </div>
  </div>
</div>


  <div class="modal hidden" id="modalDev">
    <div class="modal-card">
      <div class="modal-head">
        <h3>Developed By</h3>
        <button class="icon-btn" data-close="modalDev">‚úï</button>
      </div>
      <div class="modal-body dev-grid">
        <div class="dev-prof">
          <img src="img/professor.jpg" alt="Dr. Swaminathan Annadurai"/>
          <div class="dev-caption">
            <b>Dr. Swaminathan Annadurai</b><br/>Professor & Guide
          </div>
        </div>

        <div class="dev-card">
          <div class="dev-name">Sunesh Krishnan N</div>
          <div class="dev-reg">Reg No: 24BCE1925</div>
        </div>

        <div class="dev-card">
          <div class="dev-name">Aravind G</div>
          <div class="dev-reg">Reg No: 24BCE1293</div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal hidden" id="modalHelp">
  <div class="modal-card">
    <div class="modal-head">
      <h3>Help & Usage Guide</h3>
      <button class="icon-btn" data-close="modalHelp">‚úï</button>
    </div>
    <div class="modal-body">
      <p>This simulator lets you <b>visualize and control</b> how Go-Back-N ARQ behaves under different network conditions.</p>

      <h4>‚öôÔ∏è Controls Explained</h4>
      <ul class="bullets">
        <li><b>Number of Frames:</b> Total frames to be sent in this session.</li>
        <li><b>Window Size (N):</b> How many frames can be sent before an ACK is required.</li>
        <li><b>Timeout:</b> Duration before retransmission starts if ACKs are not received.</li>
        <li><b>Frame Loss % / Mode:</b> Simulate random or specific frame drops.</li>
        <li><b>Frame Delay:</b> Introduce delays to observe timing differences.</li>
        <li><b>ACK Loss % / Mode:</b> Simulate lost acknowledgments.</li>
        <li><b>ACK Delay:</b> Delay ACK responses for realism.</li>
      </ul>

      <h4>ü™Ñ Simulation Steps</h4>
      <ol class="steps">
        <li>Set all desired parameters (window size, losses, delays, etc.).</li>
        <li>Click <b>Start</b> to run automatically or <b>Step</b> to go frame-by-frame.</li>
        <li>Watch the animation: frames go sender ‚Üí receiver, ACKs come back.</li>
        <li>If a frame is lost or delayed, notice how the sender handles it.</li>
        <li>At the end, view <b>Event Log</b> and <b>Summary Diagram</b> for detailed results.</li>
      </ol>

      <div class="glass-lite" style="margin-top:10px;padding:10px;">
        <h4>üßæ Tips</h4>
        <ul class="bullets">
          <li>Hover over controls for tooltips (coming soon).</li>
          <li>Use <b>Step</b> mode to explain frame-by-frame behavior in class.</li>
          <li>Download the full report with logs and summary diagram using <b>Download</b>.</li>
        </ul>
      </div>

      <div style="text-align:center;margin-top:12px;">
        <button class="btn primary" data-close="modalHelp">Got it!</button>
      </div>
    </div>
  </div>
</div>

  <script src="js/app.js"></script>
</body>
</html>
